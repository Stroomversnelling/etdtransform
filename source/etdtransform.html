

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>etdtransform package &mdash; etdtransform - &#34;Energietransitie Dataset&#34; transformation and loading package 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="etdtransform" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            etdtransform - "Energietransitie Dataset" transformation and loading package
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">etdtransform</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">etdtransform package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.aggregate">etdtransform.aggregate module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.read_hh_data"><code class="docutils literal notranslate"><span class="pre">read_hh_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.add_index_columns"><code class="docutils literal notranslate"><span class="pre">add_index_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_hh_data_5min"><code class="docutils literal notranslate"><span class="pre">aggregate_hh_data_5min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.impute_hh_data_5min"><code class="docutils literal notranslate"><span class="pre">impute_hh_data_5min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.add_calculated_columns_to_hh_data"><code class="docutils literal notranslate"><span class="pre">add_calculated_columns_to_hh_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.read_aggregate"><code class="docutils literal notranslate"><span class="pre">read_aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.get_aggregate_table"><code class="docutils literal notranslate"><span class="pre">get_aggregate_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_hh_data"><code class="docutils literal notranslate"><span class="pre">resample_hh_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_project_data"><code class="docutils literal notranslate"><span class="pre">aggregate_project_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_and_save"><code class="docutils literal notranslate"><span class="pre">aggregate_and_save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_by_columns"><code class="docutils literal notranslate"><span class="pre">aggregate_by_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_variable"><code class="docutils literal notranslate"><span class="pre">aggregate_variable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_diff_cumsum"><code class="docutils literal notranslate"><span class="pre">aggregate_diff_cumsum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_sum"><code class="docutils literal notranslate"><span class="pre">aggregate_sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_max"><code class="docutils literal notranslate"><span class="pre">aggregate_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.aggregate_avg"><code class="docutils literal notranslate"><span class="pre">aggregate_avg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_and_save"><code class="docutils literal notranslate"><span class="pre">resample_and_save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_by_columns"><code class="docutils literal notranslate"><span class="pre">resample_by_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_variable"><code class="docutils literal notranslate"><span class="pre">resample_variable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_max"><code class="docutils literal notranslate"><span class="pre">resample_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_sum"><code class="docutils literal notranslate"><span class="pre">resample_sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.aggregate.resample_avg"><code class="docutils literal notranslate"><span class="pre">resample_avg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.calculated_columns">etdtransform.calculated_columns module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.add_calculated_columns_imputed_data"><code class="docutils literal notranslate"><span class="pre">add_calculated_columns_imputed_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.add_rolling_avg"><code class="docutils literal notranslate"><span class="pre">add_rolling_avg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.get_highest_avg_period"><code class="docutils literal notranslate"><span class="pre">get_highest_avg_period()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.gelijktijdigheid"><code class="docutils literal notranslate"><span class="pre">gelijktijdigheid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.get_lowest_avg_period"><code class="docutils literal notranslate"><span class="pre">get_lowest_avg_period()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.mark_coldest_two_weeks"><code class="docutils literal notranslate"><span class="pre">mark_coldest_two_weeks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.mark_highest_peak"><code class="docutils literal notranslate"><span class="pre">mark_highest_peak()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.switch_multiplier"><code class="docutils literal notranslate"><span class="pre">switch_multiplier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.calculated_columns.add_normalized_datetime"><code class="docutils literal notranslate"><span class="pre">add_normalized_datetime()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.impute">etdtransform.impute module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.calculate_average_diff"><code class="docutils literal notranslate"><span class="pre">calculate_average_diff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.concatenate_household_max_with_bounds"><code class="docutils literal notranslate"><span class="pre">concatenate_household_max_with_bounds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.concatenate_avg_diff_columns"><code class="docutils literal notranslate"><span class="pre">concatenate_avg_diff_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.equal_sig_fig"><code class="docutils literal notranslate"><span class="pre">equal_sig_fig()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.validate_household_column"><code class="docutils literal notranslate"><span class="pre">validate_household_column()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.get_reading_date_imputation_stats"><code class="docutils literal notranslate"><span class="pre">get_reading_date_imputation_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.sort_for_impute"><code class="docutils literal notranslate"><span class="pre">sort_for_impute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.get_diff_columns"><code class="docutils literal notranslate"><span class="pre">get_diff_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.prepare_diffs_for_impute"><code class="docutils literal notranslate"><span class="pre">prepare_diffs_for_impute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.read_diffs"><code class="docutils literal notranslate"><span class="pre">read_diffs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.impute.process_and_impute"><code class="docutils literal notranslate"><span class="pre">process_and_impute()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.knmi">etdtransform.knmi module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.knmi.get_project_weather_station_data"><code class="docutils literal notranslate"><span class="pre">get_project_weather_station_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.knmi.get_weather_data"><code class="docutils literal notranslate"><span class="pre">get_weather_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.knmi.load_knmi_weather_data"><code class="docutils literal notranslate"><span class="pre">load_knmi_weather_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.load_data">etdtransform.load_data module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.get_household_tables"><code class="docutils literal notranslate"><span class="pre">get_household_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.join_index_table"><code class="docutils literal notranslate"><span class="pre">join_index_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.get_weather_data_table"><code class="docutils literal notranslate"><span class="pre">get_weather_data_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.get_weather_station_table"><code class="docutils literal notranslate"><span class="pre">get_weather_station_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.join_weather_data"><code class="docutils literal notranslate"><span class="pre">join_weather_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.get_project_tables"><code class="docutils literal notranslate"><span class="pre">get_project_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.load_data.get_dfs"><code class="docutils literal notranslate"><span class="pre">get_dfs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform.vectorized_impute">etdtransform.vectorized_impute module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.ImputeType"><code class="docutils literal notranslate"><span class="pre">ImputeType</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.apply_thresholds"><code class="docutils literal notranslate"><span class="pre">apply_thresholds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.drop_temp_cols"><code class="docutils literal notranslate"><span class="pre">drop_temp_cols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.impute_and_normalize"><code class="docutils literal notranslate"><span class="pre">impute_and_normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.methods_to_bitwise"><code class="docutils literal notranslate"><span class="pre">methods_to_bitwise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.process_gap_and_cumulative_groups"><code class="docutils literal notranslate"><span class="pre">process_gap_and_cumulative_groups()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#etdtransform.vectorized_impute.process_imputation_vectorized"><code class="docutils literal notranslate"><span class="pre">process_imputation_vectorized()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-etdtransform">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">etdtransform - "Energietransitie Dataset" transformation and loading package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">etdtransform</a></li>
      <li class="breadcrumb-item active">etdtransform package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/etdtransform.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="etdtransform-package">
<h1>etdtransform package<a class="headerlink" href="#etdtransform-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-etdtransform.aggregate">
<span id="etdtransform-aggregate-module"></span><h2>etdtransform.aggregate module<a class="headerlink" href="#module-etdtransform.aggregate" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.read_hh_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">read_hh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#read_hh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L25"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.read_hh_data" title="Link to this definition"></a></dt>
<dd><p>Read household data from a parquet file and optionally add index columns to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval</strong> (<em>str</em><em>, </em><em>optional</em>) – The time interval of the data to read, by default “default”</p></li>
<li><p><strong>metadata_columns</strong> (<em>list</em><em>, </em><em>optional</em>) – Additional columns to include from the index, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The household data with optional index columns added</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function reads parquet files from a predefined folder path.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.add_index_columns">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">add_index_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#add_index_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L53"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.add_index_columns" title="Link to this definition"></a></dt>
<dd><p>Add index columns to the given DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>columns</strong> (<em>list</em><em>, </em><em>optional</em>) – Additional columns to include from the index, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame with added index columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function merges the input DataFrame with an index DataFrame based on ‘HuisIdBSV’ and ‘ProjectIdBSV’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_hh_data_5min">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_hh_data_5min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_hh_data_5min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L84"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_hh_data_5min" title="Link to this definition"></a></dt>
<dd><p>Aggregate household data into 5-minute intervals.</p>
<p class="rubric">Notes</p>
<p>This function reads individual household parquet files, concatenates them,
and saves the result as a single parquet file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.impute_hh_data_5min">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">impute_hh_data_5min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['ElektriciteitNetgebruikHoog',</span> <span class="pre">'ElektriciteitNetgebruikLaag',</span> <span class="pre">'ElektriciteitTerugleveringHoog',</span> <span class="pre">'ElektriciteitTerugleveringLaag',</span> <span class="pre">'Gasgebruik',</span> <span class="pre">'ElektriciteitsgebruikWTW',</span> <span class="pre">'ElektriciteitsgebruikWarmtepomp',</span> <span class="pre">'ElektriciteitsgebruikBooster',</span> <span class="pre">'ElektriciteitsgebruikBoilervat',</span> <span class="pre">'ElektriciteitsgebruikRadiator',</span> <span class="pre">'WarmteproductieWarmtepomp',</span> <span class="pre">'WatergebruikWarmTapwater',</span> <span class="pre">'Zon-opwekTotaal']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffs_calculated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#impute_hh_data_5min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L124"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.impute_hh_data_5min" title="Link to this definition"></a></dt>
<dd><p>Impute missing values in household data and save results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – The input DataFrame, if None it will be read from a file</p></li>
<li><p><strong>cum_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – List of cumulative columns to process, by default cumulative_columns</p></li>
<li><p><strong>sorted</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the data is already sorted, by default False</p></li>
<li><p><strong>diffs_calculated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether differences are already calculated, by default False</p></li>
<li><p><strong>optimized</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use optimized processing, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The imputed household data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function performs imputation, calculates differences, and saves various summary statistics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.add_calculated_columns_to_hh_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">add_calculated_columns_to_hh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#add_calculated_columns_to_hh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.add_calculated_columns_to_hh_data" title="Link to this definition"></a></dt>
<dd><p>Add calculated columns to household data and save the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – The input DataFrame, if None it will be read from a file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame with added calculated columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function adds calculated columns to the household data and saves the result as a parquet file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.read_aggregate">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">read_aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#read_aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L302"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.read_aggregate" title="Link to this definition"></a></dt>
<dd><p>Read an aggregate parquet file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the aggregate</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval of the aggregate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregate data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function reads a parquet file based on the provided name and interval.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.get_aggregate_table">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">get_aggregate_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#get_aggregate_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L328"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.get_aggregate_table" title="Link to this definition"></a></dt>
<dd><p>Get an aggregate table as an ibis table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the aggregate</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval of the aggregate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregate data as an ibis table</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ibis.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function reads a parquet file and returns it as an ibis table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_hh_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_hh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('60min',</span> <span class="pre">'15min',</span> <span class="pre">'5min')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_hh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L356"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_hh_data" title="Link to this definition"></a></dt>
<dd><p>Resample household data to different time intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – The input DataFrame, if None it will be read from a file</p></li>
<li><p><strong>intervals</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The time intervals to resample to, by default (“60min”, “15min”, “5min”)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples household data to specified time intervals and saves the results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_project_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_project_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('5min',</span> <span class="pre">'15min',</span> <span class="pre">'60min')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_project_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L419"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_project_data" title="Link to this definition"></a></dt>
<dd><p>Aggregate project data for different time intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intervals</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The time intervals to aggregate, by default (“5min”, “15min”, “60min”)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function aggregates project data for specified time intervals and saves the results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_and_save">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_and_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ProjectIdBSV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_and_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L450"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_and_save" title="Link to this definition"></a></dt>
<dd><p>Aggregate data and save the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>group_column</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The column(s) to group by, by default (“ProjectIdBSV”)</p></li>
<li><p><strong>interval</strong> (<em>str</em><em>, </em><em>optional</em>) – The time interval for aggregation, by default “5min”</p></li>
<li><p><strong>alt_name</strong> (<em>str</em><em>, </em><em>optional</em>) – An alternative name for the output file, by default None</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function aggregates data, merges with size information, and saves the result as a parquet file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_by_columns">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_by_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_by_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_by_columns" title="Link to this definition"></a></dt>
<dd><p>Aggregate data by columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function aggregates data for each variable defined in aggregation_variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_variable">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_grouped</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L545"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_variable" title="Link to this definition"></a></dt>
<dd><p>Aggregate a single variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_grouped</strong> (<em>pd.DataFrame</em>) – The grouped DataFrame</p></li>
<li><p><strong>var</strong> (<em>str</em>) – The variable to aggregate</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – Configuration for the aggregation</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame for the variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function aggregates a single variable based on the specified method in the config.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_diff_cumsum">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_diff_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_diff_cumsum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L602"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_diff_cumsum" title="Link to this definition"></a></dt>
<dd><p>Aggregate cumulative sum of differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to aggregate</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
<li><p><strong>combined_results</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – Previously combined results, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the cumulative sum of differences for the specified column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_sum">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L659"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_sum" title="Link to this definition"></a></dt>
<dd><p>Aggregate sum of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to aggregate</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the sum of the specified column, requiring at least 60% of values to be present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_max">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L689"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_max" title="Link to this definition"></a></dt>
<dd><p>Aggregate maximum of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to aggregate</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the maximum of the specified column, requiring at least 60% of values to be present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.aggregate_avg">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">aggregate_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#aggregate_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L719"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.aggregate_avg" title="Link to this definition"></a></dt>
<dd><p>Aggregate average of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to aggregate</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>size</strong> (<em>pd.DataFrame</em>) – DataFrame containing size information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The aggregated DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the average of the specified column, requiring at least 60% of values to be present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_and_save">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_and_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('ProjectIdBSV',</span> <span class="pre">'HuisIdBSV')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_and_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L764"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_and_save" title="Link to this definition"></a></dt>
<dd><p>Resample data and save the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>group_column</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The column(s) to group by, by default (“ProjectIdBSV”, “HuisIdBSV”)</p></li>
<li><p><strong>interval</strong> (<em>str</em><em>, </em><em>optional</em>) – The time interval for resampling, by default “5min”</p></li>
<li><p><strong>alt_name</strong> (<em>str</em><em>, </em><em>optional</em>) – An alternative name for the output file, by default None</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples data and saves the result as a parquet file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_by_columns">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_by_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'15min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_by_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L800"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_by_columns" title="Link to this definition"></a></dt>
<dd><p>Resample data by columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>group_column</strong> (<em>list</em><em>, </em><em>optional</em>) – The column(s) to group by, by default None</p></li>
<li><p><strong>interval</strong> (<em>str</em><em>, </em><em>optional</em>) – The time interval for resampling, by default “15min”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples data for each variable defined in aggregation_variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_variable">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L869"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_variable" title="Link to this definition"></a></dt>
<dd><p>Resample a single variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>var</strong> (<em>str</em>) – The variable to resample</p></li>
<li><p><strong>config</strong> (<em>dict</em>) – Configuration for the resampling</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval for resampling</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – The minimum count required for resampling</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled DataFrame for the variable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples a single variable based on the specified method in the config.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_max">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L918"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_max" title="Link to this definition"></a></dt>
<dd><p>Resample maximum of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to resample</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval for resampling</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – The minimum count required for resampling</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples the maximum of the specified column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_sum">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L954"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_sum" title="Link to this definition"></a></dt>
<dd><p>Resample sum of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to resample</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval for resampling</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – The minimum count required for resampling</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples the sum of the specified column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.aggregate.resample_avg">
<span class="sig-prename descclassname"><span class="pre">etdtransform.aggregate.</span></span><span class="sig-name descname"><span class="pre">resample_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/aggregate.html#resample_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/aggregate.py#L996"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.aggregate.resample_avg" title="Link to this definition"></a></dt>
<dd><p>Resample average of a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame.</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The column to resample.</p></li>
<li><p><strong>interval</strong> (<em>str</em>) – The time interval for resampling.</p></li>
<li><p><strong>group_column</strong> (<em>list</em>) – The column(s) to group by.</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – The minimum count required for resampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled DataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function resamples the average of the specified column, requiring at least <cite>min_count</cite> values to be present.</p>
</dd></dl>

</section>
<section id="module-etdtransform.calculated_columns">
<span id="etdtransform-calculated-columns-module"></span><h2>etdtransform.calculated_columns module<a class="headerlink" href="#module-etdtransform.calculated_columns" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.add_calculated_columns_imputed_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">add_calculated_columns_imputed_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#add_calculated_columns_imputed_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L9"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.add_calculated_columns_imputed_data" title="Link to this definition"></a></dt>
<dd><p>Add calculated columns to the input DataFrame based on existing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame containing energy usage and production data.</p></li>
<li><p><strong>fillna</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to fill missing values with 0 before performing calculations.
Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified DataFrame with additional calculated columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function assumes that the input DataFrame contains the necessary
columns such as ‘ElektriciteitTerugleveringLaagDiff’,
‘ElektriciteitTerugleveringHoogDiff’, ‘ElektriciteitNetgebruikLaagDiff’,
‘ElektriciteitNetgebruikHoogDiff’, ‘ElektriciteitsgebruikWarmtepompDiff’,
‘ElektriciteitsgebruikBoosterDiff’, ‘ElektriciteitsgebruikBoilervatDiff’,
‘ElektriciteitsgebruikWTWDiff’, ‘ElektriciteitsgebruikRadiatorDiff’,
and ‘Zon-opwekTotaalDiff’.</p></li>
<li><p>The function assumes that missing values can be treated a 0s, typically after
data cleaning and imputation.</p></li>
<li><p>The function fills missing values in each column with 0 before performing
calculations to ensure that the operations do not fail due to missing data.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.add_rolling_avg">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">add_rolling_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ElektriciteitsgebruikTotaalNetto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RollingAverage'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#add_rolling_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L148"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.add_rolling_avg" title="Link to this definition"></a></dt>
<dd><p>Add a rolling average column to each group in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>pd.DataFrame</em>) – The DataFrame group on which to perform the operation.
This should be a subset of a larger DataFrame that has been grouped by some key,
for example, <cite>df.groupby(‘some_column’).apply(add_rolling_avg)</cite>.</p></li>
<li><p><strong>var</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in ‘group’ for which the rolling average will be calculated.
Default is ‘ElektriciteitsgebruikTotaalNetto’.</p></li>
<li><p><strong>days</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of days over which to calculate the rolling average.
Default is 14 days.</p></li>
<li><p><strong>avg_var</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the new column in ‘group’ that will store the calculated rolling average values.
Default is ‘RollingAverage’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with an additional column containing the rolling averages.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function assumes that the ‘ReadingDate’ column exists in the input DataFrame and
is sorted in ascending order. The ‘ReadingDate’ column should be of datetime type.</p></li>
<li><p>The function calculates a rolling average using a window size determined by the number of days
specified and the frequency of the data points in the group. It uses a forward-looking window,
meaning that for each date, it computes the average of the next <cite>days</cite> worth of data points.</p></li>
<li><p>To handle cases where there are missing dates or irregular sampling intervals, the function
first calculates the time difference between consecutive readings to determine how many timesteps
correspond to the specified number of days. It then uses this calculated window size for the
rolling average computation.</p></li>
<li><p>The <cite>min_periods</cite> parameter in the rolling method is set to half of the window size,
ensuring that partial windows at the beginning and end of the group are still computed if they have
sufficient data points.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.get_highest_avg_period">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">get_highest_avg_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RollingAverage'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#get_highest_avg_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L209"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.get_highest_avg_period" title="Link to this definition"></a></dt>
<dd><p>Retrieve the start time, end time, and highest rolling average for each group in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>pd.DataFrame</em>) – The DataFrame group on which to perform the operation.
This should be a subset of a larger DataFrame that has been grouped by some key,
for example, <cite>df.groupby(‘some_column’).apply(get_highest_avg_period)</cite>.</p></li>
<li><p><strong>avg_var</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in ‘group’ containing the rolling averages.
Default is ‘RollingAverage’.</p></li>
<li><p><strong>days</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of days over which the rolling average was calculated.
Default is 14 days.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with columns for each group variable (if applicable), start time,
end time, and highest rolling average.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function assumes that the ‘ReadingDate’ column exists in the input DataFrame and
is sorted in ascending order. The ‘ReadingDate’ column should be of datetime type.</p></li>
<li><p>The function identifies rows with the highest value in the <cite>avg_var</cite> column and calculates
the corresponding start and end times based on the number of days specified.</p></li>
<li><p>To handle cases where there are missing dates or irregular sampling intervals, the function
first calculates the time difference between consecutive readings to determine how many timesteps
correspond to the specified number of days. It then uses this calculated window size for
determining the start and end times.</p></li>
<li><p>If the calculated start index is out of bounds (greater than or equal to the length of the group),
it sets the start index to the last valid index in the group.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.gelijktijdigheid">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">gelijktijdigheid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_5min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rolling_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RollingAverage'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#gelijktijdigheid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L297"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.gelijktijdigheid" title="Link to this definition"></a></dt>
<dd><p>Calculate the ratio of the highest rolling average of the given rolling average column between daily and 5-minute interval data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input daily DataFrame containing the data.</p></li>
<li><p><strong>df_5min</strong> (<em>pd.DataFrame</em>) – The input 5-minute interval DataFrame containing the data.</p></li>
<li><p><strong>rolling_average</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name of the rolling average. Default is “RollingAverage”.</p></li>
<li><p><strong>group_var</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name to group by. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with the group variable (if applicable) and the ratio of the highest rolling average value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.get_lowest_avg_period">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">get_lowest_avg_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RollingAvg_Temperatuur'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#get_lowest_avg_period"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L340"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.get_lowest_avg_period" title="Link to this definition"></a></dt>
<dd><p>Retrieve the start time, end time, and lowest rolling average for each group in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>pd.DataFrame</em>) – The DataFrame group on which to perform the operation.
This should be a subset of a larger DataFrame that has been grouped by some key,
for example, <cite>df.groupby(‘some_column’).apply(get_lowest_avg_period)</cite>.</p></li>
<li><p><strong>avg_var</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in ‘group’ containing the rolling averages.
Default is ‘RollingAvg_Temperatuur’.</p></li>
<li><p><strong>days</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of days over which the rolling average was calculated.
Default is 14 days.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with columns for each group variable (if applicable), start time,
end time, and lowest rolling average.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function assumes that the ‘ReadingDate’ column exists in the input DataFrame and
is sorted in ascending order. The ‘ReadingDate’ column should be of datetime type.</p></li>
<li><p>The function identifies rows with the lowest value in the <cite>avg_var</cite> column and calculates
the corresponding start and end times based on the number of days specified.</p></li>
<li><p>To handle cases where there are missing dates or irregular sampling intervals, the function
first calculates the time difference between consecutive readings to determine how many timesteps
correspond to the specified number of days. It then uses this calculated window size for
determining the start and end times.</p></li>
<li><p>If the calculated start index is out of bounds (greater than or equal to the length of the group),
it sets the start index to the last valid index in the group.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.mark_coldest_two_weeks">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">mark_coldest_two_weeks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TemperatuurRA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#mark_coldest_two_weeks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.mark_coldest_two_weeks" title="Link to this definition"></a></dt>
<dd><p>Marks the coldest two-week period for each group in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>pd.DataFrame</em>) – The DataFrame group.</p></li>
<li><p><strong>avg_var</strong> (<em>str</em>) – The variable containing the rolling averages.</p></li>
<li><p><strong>days</strong> (<em>int</em>) – The number of days over which the rolling average was calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean Series indicating whether each row is within the coldest two-week period.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.mark_highest_peak">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">mark_highest_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ElektriciteitsgebruikTotaalNetto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#mark_highest_peak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.mark_highest_peak" title="Link to this definition"></a></dt>
<dd><p>Marks the one-week period for each group in the DataFrame around the highest peak.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>pd.DataFrame</em>) – The DataFrame group.</p></li>
<li><p><strong>var</strong> (<em>str</em>) – The variable containing the peak energy use.</p></li>
<li><p><strong>days</strong> (<em>int</em>) – The number of days to include.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean Series indicating whether each row is within the one-week period around the highest peak.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.switch_multiplier">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">switch_multiplier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_choice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#switch_multiplier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L530"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.switch_multiplier" title="Link to this definition"></a></dt>
<dd><p>Returns the multiplier for the switches in the calculation of the calculated columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_choice</strong> (<em>str</em>) – The interval over which the data is aggregated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The multiplier to use in unit conversions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.calculated_columns.add_normalized_datetime">
<span class="sig-prename descclassname"><span class="pre">etdtransform.calculated_columns.</span></span><span class="sig-name descname"><span class="pre">add_normalized_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Timestamp('2023-01-02</span> <span class="pre">00:00:00')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datetime_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ReadingDate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/calculated_columns.html#add_normalized_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/calculated_columns.py#L561"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.calculated_columns.add_normalized_datetime" title="Link to this definition"></a></dt>
<dd><p>Adds a normalized datetime column to the DataFrame or Ibis Table.
Used to do analyses that depend on the time of day rather than date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.DataFrame</em><em> or </em><em>ibis.expr.types.TableExpr</em>) – The DataFrame or Table.</p></li>
<li><p><strong>reference_date</strong> (<em>datetime.datetime</em><em>, </em><em>optional</em>) – The date used as reference for the normalization. Default is ‘2023-01-02’.</p></li>
<li><p><strong>datetime_column</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column containing the datetime. Default is ‘ReadingDate’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame or Table with a new column ‘normalized_datetime’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame or ibis.expr.types.TableExpr</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-etdtransform.impute">
<span id="etdtransform-impute-module"></span><h2>etdtransform.impute module<a class="headerlink" href="#module-etdtransform.impute" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.calculate_average_diff">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">calculate_average_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/etdtransform/impute.html#calculate_average_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.calculate_average_diff" title="Link to this definition"></a></dt>
<dd><p>Calculate average differences for specified columns grouped by project and reading date.</p>
<p>This function computes the average differences for the specified columns,
excluding outliers based on a 95th percentile threshold. It’s used to prepare
data for imputation of missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame containing the data.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
<li><p><strong>diff_columns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of column names for which to calculate average differences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary where keys are column names and values are dictionaries containing:
- ‘avg_diff’: DataFrame with average differences
- ‘upper_bounds’: DataFrame with upper bounds for outlier exclusion
- ‘household_max_with_bounds’: DataFrame with household maximum values and bounds</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses a 95th percentile threshold to exclude outliers when calculating
averages. The threshold is doubled to create an upper bound for inclusion in the
average calculation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Negative difference values will raise a ValueError.</p></li>
<li><p>Missing values in the resulting average columns will be logged as errors.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.concatenate_household_max_with_bounds">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">concatenate_household_max_with_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_diff_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#concatenate_household_max_with_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.concatenate_household_max_with_bounds" title="Link to this definition"></a></dt>
<dd><p>Concatenate household maximum values and bounds for all columns.</p>
<p>This function combines the household maximum values and upper bounds
for all columns in the avg_diff_dict into a single DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_diff_dict</strong> (<em>dict</em>) – A dictionary containing average difference data for each column.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing concatenated household maximum values and bounds
for all columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function assumes that the ‘household_max_with_bounds’ key exists in each
dictionary within avg_diff_dict and contains the columns ‘ProjectIdBSV’ (or other specified project id column),
‘HuisIdBSV’, ‘{col}_huis_max’, and ‘{col}_upper_bound’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.concatenate_avg_diff_columns">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">concatenate_avg_diff_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_diff_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#concatenate_avg_diff_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L175"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.concatenate_avg_diff_columns" title="Link to this definition"></a></dt>
<dd><p>Concatenate average difference columns for all variables.</p>
<p>This function combines the average difference columns for all variables
in the avg_diff_dict into a single DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_diff_dict</strong> (<em>dict</em>) – A dictionary containing average difference data for each column.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing concatenated average difference columns
for all variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function assumes that the ‘avg_diff’ key exists in each dictionary
within avg_diff_dict and contains the columns ‘ProjectIdBSV’ or specified project_id_column, ‘ReadingDate’,
and ‘{col}_avg’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.equal_sig_fig">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">equal_sig_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_figs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#equal_sig_fig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L214"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.equal_sig_fig" title="Link to this definition"></a></dt>
<dd><p>Compare two numbers for equality up to a specified number of significant figures.</p>
<p>This function rounds both numbers to the specified number of significant figures
and then compares them for equality using a relative tolerance that scales with
the magnitude of the numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – The first number to compare.</p></li>
<li><p><strong>b</strong> (<em>float</em>) – The second number to compare.</p></li>
<li><p><strong>sig_figs</strong> (<em>int</em>) – The number of significant figures to consider for comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the numbers are equal up to the specified number of significant figures,
False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses the <cite>isclose</cite> function from the <cite>math</cite> module to compare the
rounded numbers with a relative tolerance based on the number of significant figures.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.validate_household_column">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">validate_household_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">household_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huis_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#validate_household_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L262"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.validate_household_column" title="Link to this definition"></a></dt>
<dd><p>Validate a household column for data quality and completeness.</p>
<p>This function checks a specific column in a household DataFrame for missing values,
zero values, and lack of change. It logs warnings and information about the data quality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>household_df</strong> (<em>pd.DataFrame</em>) – The DataFrame containing household data.</p></li>
<li><p><strong>cum_col</strong> (<em>str</em>) – The name of the cumulative column to validate.</p></li>
<li><p><strong>huis_code</strong> (<em>str</em>) – The unique identifier for the household.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the column passes all checks, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is currently unused in the main processing pipeline.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Logs a warning if more than 40% of values in the column are missing.</p></li>
<li><p>Logs information about the number of missing values, zero values, and lack of change.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.get_reading_date_imputation_stats">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">get_reading_date_imputation_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative_columns</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#get_reading_date_imputation_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.get_reading_date_imputation_stats" title="Link to this definition"></a></dt>
<dd><p>Calculate imputation statistics for each reading date and cumulative column.</p>
<p>This function computes various statistics related to imputation for each reading date
and cumulative column, including the number of imputed values, missing values, and
original values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The DataFrame containing the data.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
<li><p><strong>cumulative_columns</strong> (<em>list</em>) – A list of cumulative column names to analyze.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing imputation statistics for each reading date and column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is currently unused but can be applied as a sense check to ensure
not too many values are missing.</p>
<p>The resulting DataFrame includes the following columns:
- project_id_column
- ReadingDate
- column
- imputed
- na
- total_records
- original
- percent_imputed
- percent_na
- percent_original</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.sort_for_impute">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">sort_for_impute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#sort_for_impute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L415"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.sort_for_impute" title="Link to this definition"></a></dt>
<dd><p>Sort the DataFrame to prepare for imputation.</p>
<p>This function sorts the input DataFrame by project ID, household ID, and reading date.
Sorting is necessary to ensure correct imputation of missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame to be sorted.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sorted DataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The sorting order is: project ID, household ID (HuisIdBSV), and reading date (ReadingDate).
This order is crucial for the imputation process to work correctly.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.get_diff_columns">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">get_diff_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cumulative_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#get_diff_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L444"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.get_diff_columns" title="Link to this definition"></a></dt>
<dd><p>Generate difference column names from cumulative column names.</p>
<p>This function takes a list of cumulative column names and returns a list of
corresponding difference column names by appending ‘Diff’ to each name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cumulative_columns</strong> (<em>list</em>) – A list of cumulative column names.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of difference column names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is used to create names for columns that will store the differences
between consecutive cumulative values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.prepare_diffs_for_impute">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">prepare_diffs_for_impute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#prepare_diffs_for_impute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L469"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.prepare_diffs_for_impute" title="Link to this definition"></a></dt>
<dd><p>Prepare difference columns for imputation.</p>
<p>This function calculates average differences, combines them, and prepares
household maximum and bound information for imputation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame containing the data.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
<li><p><strong>cumulative_columns</strong> (<em>list</em>) – A list of cumulative column names.</p></li>
<li><p><strong>sorted</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the DataFrame is already sorted. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- diff_columns: list of difference column names
- diffs: DataFrame with average differences
- max_bound: DataFrame with household maximum and bound information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function performs the following steps:
1. Sorts the DataFrame if not already sorted.
2. Calculates average differences for each cumulative column.
3. Combines average differences and household maximum/bound information.
4. Saves the results to parquet files for later use.</p>
<p>The resulting files are saved in the directory specified by
etdtransform.options.aggregate_folder_path.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.read_diffs">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">read_diffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#read_diffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L540"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.read_diffs" title="Link to this definition"></a></dt>
<dd><p>Read average differences from a parquet file.</p>
<p>This function reads the average differences data from a parquet file
located in the aggregate folder specified in the etdtransform options.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A DataFrame containing the average differences data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function assumes that the ‘avg_diffs.parquet’ file exists in the
aggregate folder path specified in etdtransform.options.aggregate_folder_path.</p>
<p>This function is typically used to load pre-calculated average differences
for use in imputation processes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.impute.process_and_impute">
<span class="sig-prename descclassname"><span class="pre">etdtransform.impute.</span></span><span class="sig-name descname"><span class="pre">process_and_impute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffs_calculated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/impute.html#process_and_impute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/impute.py#L564"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.impute.process_and_impute" title="Link to this definition"></a></dt>
<dd><p>Process and impute missing values in the dataset.</p>
<p>This function performs data processing and imputation on the input DataFrame.
It can either calculate differences or load pre-calculated differences,
and then applies imputation methods to fill missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame containing the data to be processed and imputed.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project IDs.</p></li>
<li><p><strong>cumulative_columns</strong> (<em>list</em>) – A list of cumulative column names to be processed.</p></li>
<li><p><strong>sorted</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the DataFrame is already sorted. Default is False.</p></li>
<li><p><strong>diffs_calculated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether differences have already been calculated. Default is False.</p></li>
<li><p><strong>optimized</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use optimized imputation methods. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- df: The processed and imputed DataFrame
- imputation_summary_house: Summary of imputation statistics per house
- imputation_summary_project: Summary of imputation statistics per project
- imputation_reading_date_stats_df: Statistics of imputation by reading date</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function performs the following steps:
1. Sorts the DataFrame if not already sorted.
2. Loads or calculates differences.
3. Merges average differences into the household DataFrame.
4. Applies imputation methods (either optimized or standard).
5. Calculates and saves imputation statistics.
6. Provides warnings for high imputation percentages.</p>
<p>The function saves various statistics and summary files in the
aggregate folder specified in etdtransform.options.aggregate_folder_path.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Logs warnings if any house or project has more than 40% imputed values.</p></li>
<li><p>Logs warnings if any reading date has more than 40% imputed values.</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-etdtransform.knmi">
<span id="etdtransform-knmi-module"></span><h2>etdtransform.knmi module<a class="headerlink" href="#module-etdtransform.knmi" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.knmi.get_project_weather_station_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.knmi.</span></span><span class="sig-name descname"><span class="pre">get_project_weather_station_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/knmi.html#get_project_weather_station_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/knmi.py#L9"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.knmi.get_project_weather_station_data" title="Link to this definition"></a></dt>
<dd><p>Load and process project weather station data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame containing project weather station data with uppercase station names.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.knmi.get_weather_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.knmi.</span></span><span class="sig-name descname"><span class="pre">get_weather_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/knmi.html#get_weather_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/knmi.py#L32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.knmi.get_weather_data" title="Link to this definition"></a></dt>
<dd><p>Load and process weather data from CSV files.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame containing combined weather data from all CSV files.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.knmi.load_knmi_weather_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.knmi.</span></span><span class="sig-name descname"><span class="pre">load_knmi_weather_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/knmi.html#load_knmi_weather_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/knmi.py#L49"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.knmi.load_knmi_weather_data" title="Link to this definition"></a></dt>
<dd><p>Load and process KNMI weather data from text files in a specified folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder_path</strong> (<em>str</em>) – Path to the folder containing KNMI weather data files.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing combined and processed weather data from all files.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-etdtransform.load_data">
<span id="etdtransform-load-data-module"></span><h2>etdtransform.load_data module<a class="headerlink" href="#module-etdtransform.load_data" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.get_household_tables">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">get_household_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_weather</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Expr</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#get_household_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L23"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.get_household_tables" title="Link to this definition"></a></dt>
<dd><p>Reads household data tables for different intervals and joins them with an index table.
Optionally integrates weather data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>include_weather</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, includes weather data in the returned tables (default is True).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary where keys are interval names (e.g., ‘hourly’, ‘daily’) and values
are the corresponding Ibis tables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, ibis.Expr]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.join_index_table">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">join_index_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tbl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_join_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('HuisIdBSV',</span> <span class="pre">'ProjectIdBSV')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#join_index_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L70"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.join_index_table" title="Link to this definition"></a></dt>
<dd><p>Joins a given table with an index table on specified columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tbl</strong> (<em>ibis.Expr</em>) – The table to join.</p></li>
<li><p><strong>index_table</strong> (<em>Optional</em><em>[</em><em>ibis.Expr</em><em>]</em><em>, </em><em>optional</em>) – The index table. If None, reads from default parquet file (default is None).</p></li>
<li><p><strong>index_join_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Columns to use for the join (default is [“HuisCode”, “ProjectIdBSV”]).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The table joined with the index table.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ibis.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.get_weather_data_table">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">get_weather_data_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#get_weather_data_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L103"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.get_weather_data_table" title="Link to this definition"></a></dt>
<dd><p>Processes and transforms weather data into an Ibis table with additional calculated columns.</p>
<p>The transformations include:
- Rolling 14-day averages of temperature and perceived temperature.
- Identifying the coldest two weeks based on rolling averages.
- Adding ISO week, day of week, and weekly summary calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An Ibis table containing transformed weather data with additional calculated columns.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ibis.Expr</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The weather data is grouped by station (‘STN’) and aggregated weekly.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.get_weather_station_table">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">get_weather_station_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#get_weather_station_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.get_weather_station_table" title="Link to this definition"></a></dt>
<dd><p>Retrieves weather station data as an Ibis table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An Ibis table containing weather station data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ibis.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.join_weather_data">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">join_weather_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tbl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_station_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Expr</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Expr</span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#join_weather_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L260"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.join_weather_data" title="Link to this definition"></a></dt>
<dd><p>Joins weather data with a given table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tbl</strong> (<em>ibis.Expr</em>) – The table to join with weather data.</p></li>
<li><p><strong>weather_station_table</strong> (<em>Optional</em><em>[</em><em>ibis.Expr</em><em>]</em><em>, </em><em>optional</em>) – The weather station mapping table (default is None, meaning it will be retrieved).</p></li>
<li><p><strong>weather_table</strong> (<em>Optional</em><em>[</em><em>ibis.Expr</em><em>]</em><em>, </em><em>optional</em>) – The table containing weather data (default is None, meaning it will be retrieved).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The input table with joined weather data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ibis.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.get_project_tables">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">get_project_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_weather</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Expr</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/etdtransform/load_data.html#get_project_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L320"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.get_project_tables" title="Link to this definition"></a></dt>
<dd><p>Retrieves aggregate project data tables from Parquet files, integrates weather data,
and returns a dictionary of Ibis tables for each interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary where keys are intervals (and additional metadata like
‘project_weather’) and values are the corresponding Ibis tables with integrated weather data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, ibis.Expr]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.load_data.get_dfs">
<span class="sig-prename descclassname"><span class="pre">etdtransform.load_data.</span></span><span class="sig-name descname"><span class="pre">get_dfs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/load_data.html#get_dfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/load_data.py#L354"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.load_data.get_dfs" title="Link to this definition"></a></dt>
<dd><p>Reads the aggregate data from the parquet files and adds weather data for analysis. It returns a dictionary of DataFrames for each interval.</p>
</dd></dl>

</section>
<section id="module-etdtransform.vectorized_impute">
<span id="etdtransform-vectorized-impute-module"></span><h2>etdtransform.vectorized_impute module<a class="headerlink" href="#module-etdtransform.vectorized_impute" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">ImputeType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#ImputeType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L785"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IntFlag</span></code></p>
<p>Enumeration of imputation types used in the vectorized imputation process.</p>
<p>This class defines the different types of imputation methods applied
during the vectorized imputation process for handling missing or
problematic data in time series.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.NONE">
<span class="sig-name descname"><span class="pre">NONE</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.NONE" title="Link to this definition"></a></dt>
<dd><p>Represents no imputation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.NEGATIVE_GAP_JUMP">
<span class="sig-name descname"><span class="pre">NEGATIVE_GAP_JUMP</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.NEGATIVE_GAP_JUMP" title="Link to this definition"></a></dt>
<dd><p>Represents a negative gap jump. Fills with zeros (potentially a meter reset)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.NEAR_ZERO_GAP_JUMP">
<span class="sig-name descname"><span class="pre">NEAR_ZERO_GAP_JUMP</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.NEAR_ZERO_GAP_JUMP" title="Link to this definition"></a></dt>
<dd><p>Represents a gap jump near zero. Fills with zeros (no change).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.LINEAR_FILL">
<span class="sig-name descname"><span class="pre">LINEAR_FILL</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.LINEAR_FILL" title="Link to this definition"></a></dt>
<dd><p>Represents a linear fill for positive gaps with near-zero impute jumps based on average.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.SCALED_FILL">
<span class="sig-name descname"><span class="pre">SCALED_FILL</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.SCALED_FILL" title="Link to this definition"></a></dt>
<dd><p>Represents a scaled fill for positive gaps with positive impute jumps based on average.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.ZERO_END_VALUE">
<span class="sig-name descname"><span class="pre">ZERO_END_VALUE</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.ZERO_END_VALUE" title="Link to this definition"></a></dt>
<dd><p>Represents imputation when end value is zero and there is no start value. Fills with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.POSITIVE_END_VALUE">
<span class="sig-name descname"><span class="pre">POSITIVE_END_VALUE</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.POSITIVE_END_VALUE" title="Link to this definition"></a></dt>
<dd><p>Represents imputation when end value is positive but there is no start value. Fills with averages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.NO_END_VALUE">
<span class="sig-name descname"><span class="pre">NO_END_VALUE</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.NO_END_VALUE" title="Link to this definition"></a></dt>
<dd><p>Represents imputation when there is no end value. Fills with averages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.ImputeType.THRESHOLD_ADJUSTED">
<span class="sig-name descname"><span class="pre">THRESHOLD_ADJUSTED</span></span><a class="headerlink" href="#etdtransform.vectorized_impute.ImputeType.THRESHOLD_ADJUSTED" title="Link to this definition"></a></dt>
<dd><p>Represents values adjusted due to threshold violations. This happens after imputation and could be triggered by imputed values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>The THRESHOLD_ADJUSTED flag can be combined with other imputation types.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.apply_thresholds">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">apply_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impute_type_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_imputed_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#apply_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.apply_thresholds" title="Link to this definition"></a></dt>
<dd><p>Apply thresholds to difference column and update imputation flags.</p>
<p>This function applies lower and upper bounds to a difference column in the
DataFrame. Values outside these bounds are replaced with average values,
and corresponding imputation flags are updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The input DataFrame containing the data.</p></li>
<li><p><strong>lower_bound</strong> (<em>float</em>) – The lower threshold for the difference column.</p></li>
<li><p><strong>upper_bound</strong> (<em>float</em>) – The upper threshold for the difference column.</p></li>
<li><p><strong>diff_col</strong> (<em>str</em>) – The name of the difference column to apply thresholds to.</p></li>
<li><p><strong>avg_col</strong> (<em>str</em>) – The name of the column containing average values to use for imputation.</p></li>
<li><p><strong>impute_type_col</strong> (<em>str</em>) – The name of the column indicating the imputation type.</p></li>
<li><p><strong>is_imputed_col</strong> (<em>str</em>) – The name of the column indicating whether a value is imputed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame with thresholds applied and imputation flags updated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function modifies the input DataFrame in-place and also returns it.
Values outside the thresholds are replaced with average values and marked
as imputed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.drop_temp_cols">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">drop_temp_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logLeftoverError</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#drop_temp_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L276"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.drop_temp_cols" title="Link to this definition"></a></dt>
<dd><p>Drop temporary columns from the DataFrame.</p>
<p>This function removes specified temporary columns from the DataFrame.
If no columns are specified, it drops a predefined set of temporary columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame from which to drop columns.</p></li>
<li><p><strong>temp_cols</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of column names to drop. If None, a default set of temporary
columns will be used.</p></li>
<li><p><strong>logLeftoverError</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, log an error message for any leftover columns to be removed.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function modifies the DataFrame in-place.</p>
<p>The default set of temporary columns includes various intermediate
calculation columns used in the imputation process.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>If logLeftoverError is True and there are columns to be dropped, an error
message will be logged, which might indicate unintended remnants in the
data processing pipeline.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.impute_and_normalize">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">impute_and_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#impute_and_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L112"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.impute_and_normalize" title="Link to this definition"></a></dt>
<dd><p>Perform vectorized imputation and normalization on cumulative columns</p>
<p>This function applies imputation techniques to fill missing values in
cumulative columns and normalizes the data. It uses vectorized operations
for improved performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The input DataFrame containing the data to be imputed and normalized.</p></li>
<li><p><strong>cumulative_columns</strong> (<em>list</em>) – A list of column names representing cumulative variables to be processed.</p></li>
<li><p><strong>project_id_column</strong> (<em>str</em>) – The name of the column containing project identifiers.</p></li>
<li><p><strong>max_bound</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing maximum bounds for each variable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing three elements:</p>
<ul class="simple">
<li><dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>The imputed and normalized DataFrame.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>imputation_gap_stats_df<span class="classifier">pandas.DataFrame</span></dt><dd><p>Statistics about the imputation process for each gap.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>imputation_reading_date_stats_df<span class="classifier">None or pandas.DataFrame</span></dt><dd><p>Statistics about imputation by reading date (if calculated).</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function applies various imputation methods based on the nature of
the missing data and the available information. It handles different
scenarios such as gaps in data, zero jumps, and negative jumps.</p>
<p>The function also calculates and returns statistics about the imputation
process, which can be useful for quality assessment.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The function may modify the input DataFrame in-place.</p></li>
<li><p>Imputation methods may introduce bias or affect the variance of the data.</p></li>
<li><p>Large amounts of imputed data may significantly affect analysis results.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.methods_to_bitwise">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">methods_to_bitwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#methods_to_bitwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L18"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.methods_to_bitwise" title="Link to this definition"></a></dt>
<dd><p>Convert methods to bitwise representation.</p>
<p>This function takes a column of methods and converts each method to a bitwise
representation. Each method is represented by a bit in the resulting integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>methods_column</strong> (<em>array-like</em>) – A column containing lists of method numbers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of integers where each integer represents the bitwise
representation of the methods for that row.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function assumes that method numbers start from 1 and correspond to
bit positions (method 1 = bit 0, method 2 = bit 1, etc.).</p>
<p>This vectorized version is optimized for performance with NumPy.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.process_gap_and_cumulative_groups">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">process_gap_and_cumulative_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#process_gap_and_cumulative_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L343"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.process_gap_and_cumulative_groups" title="Link to this definition"></a></dt>
<dd><p>Process gap and cumulative value groups in the DataFrame.</p>
<p>This function identifies gaps in the data, creates gap groups, and
establishes cumulative value groups based on the presence of NA values
and transitions between households.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame to process.</p></li>
<li><p><strong>diff_col</strong> (<em>str</em>) – The name of the difference column to analyze for gaps.</p></li>
<li><p><strong>cum_col</strong> (<em>str</em>) – The name of the cumulative column to use for value grouping.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed DataFrame with added columns for gap and cumulative
value grouping.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function adds several temporary columns to the DataFrame:
- ‘gap_start’: Identifies the start of a diff column gap or transition between households.
- ‘gap_group’: Groups consecutive NA values in diff columns.
- ‘cum_value_encountered’: Marks where a non-NA value is encountered in cumulative column.
- ‘cumulative_value_group’: Groups gaps based on cumulative values.
- ‘gap_length’: The length of each gap group.</p>
<p>These columns are crucial for the subsequent imputation process. It returns only for further imputation:
- ‘cumulative_value_group’
- ‘gap_length’</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This function modifies the input DataFrame in-place.</p></li>
<li><p>The added columns should be handled carefully in subsequent processing steps.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="etdtransform.vectorized_impute.process_imputation_vectorized">
<span class="sig-prename descclassname"><span class="pre">etdtransform.vectorized_impute.</span></span><span class="sig-name descname"><span class="pre">process_imputation_vectorized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cum_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impute_type_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_imputed_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/etdtransform/vectorized_impute.html#process_imputation_vectorized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/Stroomversnelling/etdtransform/blob/main/etdtransform/vectorized_impute.py#L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#etdtransform.vectorized_impute.process_imputation_vectorized" title="Link to this definition"></a></dt>
<dd><p>Perform vectorized imputation on the DataFrame.</p>
<p>This function applies various imputation methods to fill missing values
in the difference column based on cumulative values and average differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The DataFrame to impute.</p></li>
<li><p><strong>diff_col</strong> (<em>str</em>) – The name of the difference column to impute.</p></li>
<li><p><strong>cum_col</strong> (<em>str</em>) – The name of the cumulative column used for imputation.</p></li>
<li><p><strong>avg_col</strong> (<em>str</em>) – The name of the column containing average differences.</p></li>
<li><p><strong>impute_type_col</strong> (<em>str</em>) – The name of the column to store imputation type.</p></li>
<li><p><strong>is_imputed_col</strong> (<em>str</em>) – The name of the column to indicate whether a value is imputed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame with imputed values and additional columns indicating
imputation types and statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function applies several imputation methods for diff columns:
- Filling with zeros for flat or near-zero gaps
- Linear filling for positive gaps with near-zero impute jumps
- Scaled impute value filling for positive gaps with positive impute jumps
- Handling cases with no gap jump (e.g., at the start or end of the dataset)</p>
<p>The function also applies thresholds to remove physically impossible outliers.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This function modifies the input DataFrame in-place.</p></li>
<li><p>The imputation process may introduce bias, especially in cases with large gaps
or when a significant portion of the data is imputed.</p></li>
<li><p>The function assumes that the input data has been properly prepared and sorted.</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="module-etdtransform">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-etdtransform" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="etdtransform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Nicolas Dickinson, Marten Witkamp, Petra Izeboud.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>